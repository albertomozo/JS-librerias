<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pedido con EmailJS</title>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function() {
      emailjs.init("OSqWAA6uYZbvJTbor"); // Reemplaza con tu Public Key
    })();
  </script>
</head>
<body>
  <h1>Carrito de compra</h1>

  <!-- Formulario para los datos del cliente -->
  <form id="pedidoForm">
    <input type="text" id="nombre" placeholder="Tu nombre" required><br>
    <input type="email" id="correo" placeholder="Tu email" required><br>
    <button type="submit">Finalizar pedido</button>
  </form>

  <script>
    // Ejemplo: simular un carrito en localStorage
    if (!localStorage.getItem("carrito")) {
      const carritoDemo = [
        { producto: "Camiseta", cantidad: 2, precio: 15 },
        { producto: "Pantal√≥n", cantidad: 1, precio: 30 }
      ];
      localStorage.setItem("carrito", JSON.stringify(carritoDemo));
    }

    document.getElementById("pedidoForm").addEventListener("submit", function(e) {
      e.preventDefault();

      // Recuperar datos
      const nombre = document.getElementById("nombre").value;
      const correo = document.getElementById("correo").value;
      const carrito = JSON.parse(localStorage.getItem("carrito")) || [];

      // Formatear pedido

      let pedidoTexto = carrito.map(item =>
        `${item.producto} - Cantidad: ${item.cantidad} - Precio: ${item.precio}‚Ç¨`
      ).join("\n");
      console.log("üü© Formato del pedido:\n", pedidoTexto);

      // Par√°metros para la plantilla de EmailJS
      const templateParams = {
        cliente: nombre,
        email: correo,
        pedido: pedidoTexto
      };
      console.log("üü© Datos del pedido:", templateParams);

      // Enviar con EmailJS
      emailjs.send("service_exqwrqo", "template_e6d2qlf", templateParams)
        .then(function(response) {
          alert("‚úÖ Pedido enviado correctamente");
          console.log("SUCCESS!", response.status, response.text);
          localStorage.removeItem("carrito"); // Vaciar carrito
        }, function(error) {
          alert("‚ùå Error al enviar pedido");
          console.log("FAILED...", error);
        });
    });
  </script>
</body>
</html>